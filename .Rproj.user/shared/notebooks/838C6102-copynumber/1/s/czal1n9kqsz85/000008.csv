"0","cap = ""\\label{fig:CBS_1} CBS result for different noise level. Green: raw probe response; Blue: theoretical model; Red: CBS segmentation"""
"0","par(mfrow = c(3,2))"
"0","# sigmas = c(0.05,0.1,0.2,0.4)"
"0","res = vector('list',length(sigmas))"
"0","par(mai = rep(0.4,4), omi = rep(0.2,4))"
"0","##### For visualisation, take a small piece of 2E3"
"0","chrome_idx = 1"
"0","idxs = 1:1E3"
"0","for (i in 1:length(sigmas)){"
"0","  sigma = sigmas[i]"
"0","  noisy_log_cpnum_act = noisy( log_cpnum_act, sigma =sigma, relative = F) #### Absolute error is used here"
"0","  vct = noisy_log_cpnum_act[idxs]"
"0","  df  = data.frame(chromosome = chrome_idx,"
"0","                   vct,"
"0","                   position = probeidx[idxs])"
"0","  #### Run DNACopy for segmentation"
"0","  CNA.object <- CNA(cbind(vct),"
"0","                    df$chromosome, df$position,"
"0","                    data.type=""logratio"",sampleid=sprintf(""simulated sigma=%.3f"", sigma))"
"0","  smoothed.CNA.object <- smooth.CNA(CNA.object)"
"0","  segment.smoothed.CNA.object <- segment(smoothed.CNA.object, verbose=1)"
"0","  "
"0","  #### Plot it"
"0","  plot(segment.smoothed.CNA.object,type=""w"", ylim = c(-2, 2), xlim = c(0,2000),"
"0","       xlab = 'Probe index',"
"0","       ylab = 'logR')"
"0","  lines(log_cpnum_act[idxs],col='blue')"
"0","}"
"1","Analyzing: simulated.sigma.0.200 
"
"1","Analyzing: simulated.sigma.0.319 
"
"1","Analyzing: simulated.sigma.0.493 
"
"1","Analyzing: simulated.sigma.0.751 
"
"1","Analyzing: simulated.sigma.1.131 
"
"1","Analyzing: simulated.sigma.1.691 
"
